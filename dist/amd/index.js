var __awaiter=this&&this.__awaiter||function(t,r,e,o){return new(e||(e=Promise))(function(i,s){function n(t){try{u(o.next(t))}catch(t){s(t)}}function a(t){try{u(o.throw(t))}catch(t){s(t)}}function u(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e(function(t){t(r)})).then(n,a)}u((o=o.apply(t,r||[])).next())})};define("index",["require","exports","named-logs"],function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.TorusModuleLoader=void 0;const o=e.logs("web3w-torus:index");let i;const s={1:{host:"mainnet",networkName:"Main Ethereum Network"},3:{host:"ropsten",networkName:"Ropsten Test Network"},4:{host:"rinkeby",networkName:"Rinkeby Test Network"},5:{host:"goerli",networkName:"Goerli Test Network"},42:{host:"kovan",networkName:"Kovan Test Network"}};class n{constructor(t,r){this.id=t,r=r||{};const{forceFallbackUrl:e,fallbackUrl:o,chainId:i,verifier:s}=r;this.chainId=i,this.forceFallbackUrl=e,this.fallbackUrl=o,this.verifier=s}setup(t){return __awaiter(this,void 0,void 0,function*(){t=t||{};let{chainId:r,fallbackUrl:e,verifier:n}=t;if(r=r||this.chainId,e=e||this.fallbackUrl,n=n||this.verifier,e&&!r){const t=yield fetch(e,{headers:{"content-type":"application/json; charset=UTF-8"},body:JSON.stringify({id:Math.floor(1e6*Math.random()),jsonrpc:"2.0",method:"eth_chainId",params:[]}),method:"POST"}),o=yield t.json();r=parseInt(o.result.slice(2),16).toString()}if(!r)throw new Error("chainId missing");const a=s[r];let u;u=a&&!this.forceFallbackUrl?Object.assign(Object.assign({},a),{chainId:parseInt(r)}):{host:e,chainId:parseInt(r)},this.torusWrapper=new i,yield this.torusWrapper.init({network:u,showTorusButton:!1}),this.torusWrapper.showTorusButton();try{const t=yield this.torusWrapper.login(n?{verifier:n}:void 0);o.log({torusLoginResult:t})}catch(t){if(this.torusWrapper.hideTorusButton(),"User cancelled login"===t.message||"user closed popup"===t.message)throw new Error("USER_CANCELED");throw t}return window.torusWrapper=this.torusWrapper,{web3Provider:this.torusWrapper.provider,chainId:r}})}disconnect(){this.torusWrapper=void 0,window.torusWrapper=void 0}logout(){return __awaiter(this,void 0,void 0,function*(){this.torusWrapper.hideTorusButton();try{yield this.torusWrapper.logout()}catch(t){}})}isLoggedIn(){return __awaiter(this,void 0,void 0,function*(){let t;try{t=yield this.torusWrapper.getUserInfo()}catch(t){return!1}return!!t})}showWallet(){this.torusWrapper.showWallet()}showButton(){this.torusWrapper.showTorusButton()}hideButton(){this.torusWrapper.hideTorusButton()}initiateTopup(t,r){return __awaiter(this,void 0,void 0,function*(){yield this.torusWrapper.initiateTopup(t,r)})}}class a{constructor(t){const r=t&&t.verifier;this.id=r?"torus-"+r:"torus",this.moduleConfig=t}static setJsURL(t,r){if(a._jsURLUsed)throw new Error("cannot change js url once used");a._jsURL=t,a._jsURLIntegrity=r}load(){return __awaiter(this,void 0,void 0,function*(){if(!i){const t=a._jsURL,r=a._jsURLIntegrity;a._jsURLUsed=!0;try{yield function(t,r,e){return new Promise(function(o,i){const s=document.createElement("script");s.type="text/javascript",s.src=t,r&&(s.integrity=r),e&&(s.crossOrigin=e),s.onload=s.onreadystatechange=function(){o()},s.onerror=function(){i()},document.head.appendChild(s)})}(t,r,"anonymous")}catch(t){throw a._jsURLUsed=!1,t}i=window.Torus}return new n(this.id,this.moduleConfig)})}}r.TorusModuleLoader=a,a._jsURL="https://cdn.jsdelivr.net/npm/@toruslabs/torus-embed",a._jsURLUsed=!1});