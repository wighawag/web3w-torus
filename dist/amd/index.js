var __awaiter=this&&this.__awaiter||function(t,e,r,o){return new(r||(r=Promise))(function(i,s){function n(t){try{u(o.next(t))}catch(t){s(t)}}function a(t){try{u(o.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(n,a)}u((o=o.apply(t,e||[])).next())})};define("index",["require","exports","named-logs"],function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TorusModule=void 0;const o=r.logs("web3w-torus:index");let i;const s={1:{host:"mainnet",networkName:"Main Ethereum Network"},3:{host:"ropsten",networkName:"Ropsten Test Network"},4:{host:"rinkeby",networkName:"Rinkeby Test Network"},5:{host:"goerli",networkName:"Goerli Test Network"},42:{host:"kovan",networkName:"Kovan Test Network"}};e.TorusModule=class{constructor(t){this.id="torus",t=t||{};const{forceFallbackUrl:e,fallbackUrl:r,chainId:o,jsURL:i,jsURLIntegrity:s,verifier:n}=t;this.id="torus",this.jsURL=i,this.jsURLIntegrity=s,this.chainId=o,this.forceFallbackUrl=e,this.fallbackUrl=r,this.verifier=n}setup(t){return __awaiter(this,void 0,void 0,function*(){t=t||{};let{chainId:e,fallbackUrl:r,verifier:n}=t;e=e||this.chainId,r=r||this.fallbackUrl,n=n||this.verifier;const a=this.jsURL||"https://cdn.jsdelivr.net/npm/@toruslabs/torus-embed",u=this.jsURLIntegrity;if(yield function(t,e,r){return new Promise(function(o,i){const s=document.createElement("script");s.type="text/javascript",s.src=t,e&&(s.integrity=e),r&&(s.crossOrigin=r),s.onload=s.onreadystatechange=function(){o()},s.onerror=function(){i()},document.head.appendChild(s)})}(a,u,"anonymous"),i=window.Torus,r&&!e){const t=yield fetch(r,{headers:{"content-type":"application/json; charset=UTF-8"},body:JSON.stringify({id:Math.floor(1e6*Math.random()),jsonrpc:"2.0",method:"eth_chainId",params:[]}),method:"POST"}),o=yield t.json();e=parseInt(o.result.slice(2),16).toString()}if(!e)throw new Error("chainId missing");const h=s[e];let c;c=h&&!this.forceFallbackUrl?Object.assign(Object.assign({},h),{chainId:parseInt(e)}):{host:r,chainId:parseInt(e)},this.torusWrapper=new i,yield this.torusWrapper.init({network:c,showTorusButton:!1}),this.torusWrapper.showTorusButton();try{const t=yield this.torusWrapper.login(n?{verifier:n}:void 0);o.log({torusLoginResult:t})}catch(t){if(this.torusWrapper.hideTorusButton(),"User cancelled login"===t.message||"user closed popup"===t.message)throw new Error("USER_CANCELED");throw t}return window.torusWrapper=this.torusWrapper,{web3Provider:this.torusWrapper.provider,chainId:e}})}logout(){return __awaiter(this,void 0,void 0,function*(){this.torusWrapper.hideTorusButton();try{yield this.torusWrapper.logout()}catch(t){}})}isLoggedIn(){return __awaiter(this,void 0,void 0,function*(){let t;try{t=yield this.torusWrapper.getUserInfo()}catch(t){return!1}return!!t})}showWallet(){this.torusWrapper.showWallet()}showButton(){this.torusWrapper.showTorusButton()}hideButton(){this.torusWrapper.hideTorusButton()}initiateTopup(t,e){return __awaiter(this,void 0,void 0,function*(){yield this.torusWrapper.initiateTopup(t,e)})}}});